<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Detect heatwaves and cold-spells. — detect_event • heatwaveR</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


<meta property="og:title" content="Detect heatwaves and cold-spells. — detect_event" />

<meta property="og:description" content="Applies the Hobday et al. (2016) marine heat wave definition to an input time
series of a given value (usually, but not necessarily limited to, temperature)
along with a daily date vector and pre-calculated seasonal and threshold
climatologies, which may either be created with ts2clm or some
other means." />

<meta property="og:image" content="https://robwschlegel.github.io/heatwaveR/index.html/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118123016-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118123016-1');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">heatwaveR</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/detection_and_visualisation.html">Basic detection and visualisation</a>
    </li>
    <li>
      <a href="../articles/exceedance.html">Calculating exceedances</a>
    </li>
    <li>
      <a href="../articles/event_categories.html">Calculating categories</a>
    </li>
    <li>
      <a href="../articles/complex_clims.html">Complex climatologies</a>
    </li>
    <li>
      <a href="../articles/OISST_preparation.html">OISST preparation</a>
    </li>
    <li>
      <a href="../articles/gridded_event_detection.html">Extreme event detection in gridded data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/robwschlegel/heatwaveR">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detect heatwaves and cold-spells.</h1>
    <small class="dont-index">Source: <a href='https://github.com/robwschlegel/heatwaveR/blob/master/R/detect_event.R'><code>R/detect_event.R</code></a></small>
    <div class="hidden name"><code>detect_event.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Applies the Hobday et al. (2016) marine heat wave definition to an input time
series of a given value (usually, but not necessarily limited to, temperature)
along with a daily date vector and pre-calculated seasonal and threshold
climatologies, which may either be created with <code><a href='ts2clm.html'>ts2clm</a></code> or some
other means.</p>
    
    </div>

    <pre class="usage"><span class='fu'>detect_event</span>(<span class='no'>data</span>, <span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>t</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>temp</span>, <span class='kw'>seasClim</span> <span class='kw'>=</span> <span class='no'>seas</span>,
  <span class='kw'>threshClim</span> <span class='kw'>=</span> <span class='no'>thresh</span>, <span class='kw'>threshClim2</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>minDuration</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>minDuration2</span> <span class='kw'>=</span> <span class='no'>minDuration</span>, <span class='kw'>joinAcrossGaps</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>maxGap</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>maxGap2</span> <span class='kw'>=</span> <span class='no'>maxGap</span>, <span class='kw'>coldSpells</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame with at least four columns. In the default setting
(i.e. ommitting the arguments <code>x</code>, <code>y</code>, <code>seas</code>, and <code>thresh</code>;
see immediately below), the data set is expected to have the headers <code>t</code>,
<code>temp</code>, <code>seas</code>, and <code>thresh</code>. The <code>t</code>
column is a vector of dates of class <code>Date</code>, <code>temp</code> is the measured
variable (by default it is assumed to be temperature), <code>seas</code> is the seasonal
cycle daily climatology (366 days), and <code>thresh</code> is the seasonal cycle
daily threshold above which events may be detected. Data of the appropriate
format are created by the function <code><a href='ts2clm.html'>ts2clm</a></code>, but your own data
can be supplied if they meet the criteria specified by <code><a href='ts2clm.html'>ts2clm</a></code>
If the column names of <code>data</code> match those outlined here, the following
four arguments may be ignored.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>This column is expected to contain a vector of dates as per the
specification of <code><a href='ts2clm.html'>ts2clm</a></code>. If a column headed <code>t</code> is present in
the dataframe, this argument may be ommitted; otherwise, specify the name of
the column with dates here.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>This is a column containing the measurement variable. If the column
name differs from the default (i.e. <code>temp</code>), specify the name here.</p></td>
    </tr>
    <tr>
      <th>seasClim</th>
      <td><p>This function will assume that the seasonal climatology column
is called <code>seas</code> as this matches the output of <code><a href='ts2clm.html'>ts2clm</a></code>.
If the column name for the seasonal climatology is different, provide that here.</p></td>
    </tr>
    <tr>
      <th>threshClim</th>
      <td><p>The threshold climatology column should be called
<code>thresh</code>. If it is not, provide the name of the threshold column here.</p></td>
    </tr>
    <tr>
      <th>threshClim2</th>
      <td><p>If one wishes to provide a second climatology threshold
filter for the more rigorous detection of events, a vector or column conataining
logical values (i.e. TRUE FALSE) should be provided here. By default this
argument is ignored. It's primary purpose is to allow for the inclusion of
tMin and tMax thresholds.</p></td>
    </tr>
    <tr>
      <th>minDuration</th>
      <td><p>The minimum duration for acceptance of detected events.
The default is <code>5</code> days.</p></td>
    </tr>
    <tr>
      <th>minDuration2</th>
      <td><p>The minimum duration for acceptance of events after
filtering by <code>threshClim</code> and <code>threshClim</code>. By default
<code>minDuration2 = minDuration</code> and is ignored if <code>threshClim2</code> has not
been specified.</p></td>
    </tr>
    <tr>
      <th>joinAcrossGaps</th>
      <td><p>Boolean switch indicating whether to join events which
occur before/after a short gap as specified by <code>maxGap</code>. The default
is <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>maxGap</th>
      <td><p>The maximum length of gap allowed for the joining of MHWs. The
default is <code>2</code> days.</p></td>
    </tr>
    <tr>
      <th>maxGap2</th>
      <td><p>The maximum gap length after applying both thresholds.
By default <code>maxGap2 = maxGap</code> and is ignored if <code>threshClim2</code> has not
been specified.</p></td>
    </tr>
    <tr>
      <th>coldSpells</th>
      <td><p>Boolean specifying if the code should detect cold events
instead of warm events. The default is <code>FALSE</code>. Please note that the
climatological thresholds for cold-spells are considered to be the inverse
of those for MHWs. For example, the default setting for the detection of
MHWs is <code>pctile = 90</code>, as seen in <code><a href='ts2clm.html'>ts2clm</a></code>. Should one want
to use <code>detect_event</code> for MCSs, this threshold would best be generated
in <code><a href='ts2clm.html'>ts2clm</a></code> by setting <code>pctile = 10</code> (see example below).
Any value may be used, but this is the setting used for the calculation of
MCSs in Schlegel et al. (2017a).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function will return a list of two tibbles (see the <code>tidyverse</code>),
<code>climatology</code> and <code>event</code>, which are, surprisingly, the climatology
and events, respectively. The climatology contains the full time series of
daily temperatures, as well as the the seasonal climatology, the threshold
and various aspects of the events that were detected. The software was
designed for detecting extreme thermal events, and the units specified below
reflect that intended purpose. However, various other kinds of extreme
events may be detected according to the specifications, and if that is the
case, the appropriate units need to be determined by the user.</p>
<dt>doy</dt><dd><p>Julian day (day-of-year). For non-leap years it runs 1...59 and
  61...366, while leap years run 1...366. This column will be named differently if
  another name was specified to the <code>doy</code> argument.</p></dd>
  <dt>t</dt><dd><p>The date of the temperature measurement. This column will be
  named differently if another name was specified to the <code>x</code> argument.</p></dd>
  <dt>temp</dt><dd><p>If the software was used for the purpose for which it was designed,
  seawater temperature [deg. C] on the specified date will be returned. This
  column will of course be named differently if another kind of measurement was
  specified to the <code>y</code> argument.</p></dd>
  <dt>seas</dt><dd><p>Daily climatological seasonal cycle [deg. C].</p></dd>
  <dt>thresh</dt><dd><p>Daily climatological threshold cycle (e.g., 90th
  percentile) [deg. C].</p></dd>
  <dt>var</dt><dd><p>Seasonally varying standard deviation [deg. C].</p></dd>
  <dt>threshCriterion</dt><dd><p>Boolean indicating if <code>temp</code> exceeds
  <code>thresh</code>.</p></dd>
  <dt>durationCriterion</dt><dd><p>Boolean indicating whether periods of consecutive
  <code>threshCriterion</code> are &gt;= <code>min_duration</code>.</p></dd>
  <dt>event</dt><dd><p>Boolean indicating if all criteria that define an extreme event
  are met.</p></dd>
  <dt>event_no</dt><dd><p>A sequential number indicating the ID and order of
  occurence of the events.</p></dd>

The events are summarised using a range of event metrics:
  <dt>event_no</dt><dd><p>A sequential number indicating the ID and order of
  the events.</p></dd>
  <dt>index_start</dt><dd><p>Start index of event.</p></dd>
  <dt>index_end</dt><dd><p>End index of event.</p></dd>
  <dt>duration</dt><dd><p>Duration of event [days].</p></dd>
  <dt>date_start</dt><dd><p>Start date of event [date].</p></dd>
  <dt>date_end</dt><dd><p>End date of event [date].</p></dd>
  <dt>date_peak</dt><dd><p>Date of event peak [date].</p></dd>
  <dt>intensity_mean</dt><dd><p>Mean intensity [deg. C].</p></dd>
  <dt>intensity_max</dt><dd><p>Maximum (peak) intensity [deg. C].</p></dd>
  <dt>intensity_var</dt><dd><p>Intensity variability (standard deviation) [deg. C].</p></dd>
  <dt>intensity_cumulative</dt><dd><p>Cumulative intensity [deg. C x days].</p></dd>
  <dt>rate_onset</dt><dd><p>Onset rate of event [deg. C / day].</p></dd>
  <dt>rate_decline</dt><dd><p>Decline rate of event [deg. C / day].</p></dd>

intensity_max_relThresh, intensity_mean_relThresh,
intensity_var_relThresh, and intensity_cumulative_relThresh
are as above except relative to the threshold (e.g., 90th percentile) rather
than the seasonal climatology.

intensity_max_abs, intensity_mean_abs, intensity_var_abs, and
intensity_cumulative_abs are as above except as absolute magnitudes
rather than relative to the seasonal climatology or threshold.

Note that rate_onset and rate_decline will return NA
when the event begins/ends on the first/last day of the time series. This
may be particularly evident when the function is applied to large gridded
data sets. Although the other metrics do not contain any errors and
provide sensible values, please take this into account in its
interpretation.

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <ol>
<li><p>This function assumes that the input time series consists of continuous
daily values with few missing values. Time ranges which start and end
part-way through the calendar year are supported. The accompanying function
<code><a href='ts2clm.html'>ts2clm</a></code> aids in the preparation of a time series that is
suitable for use with <code>detect_event</code>, although this may also be accomplished
'by hand' as long as the criteria are met as discussed in the documentation
to <code><a href='ts2clm.html'>ts2clm</a></code>.</p></li>
<li><p>The calculation of onset and decline rates assumes that the events
started a half-day before the start day and ended a half-day after the
end-day. This is consistent with the duration definition as implemented,
which assumes duration = end day - start day + 1. An event that is already
present at the beginning of a time series, or an event that is still present
at the end of a time series, will report the rate of onset or the rate of
decline as <code>NA</code>, as it is impossible to know what the temperature half a
day before or after the start or end of the event is.</p></li>
<li><p>For the purposes of event detection, any missing temperature values not
interpolated over (through optional <code>maxPadLength</code> in <code><a href='ts2clm.html'>ts2clm</a></code>)
will be set equal to the seasonal climatology. This means they will trigger
the end/start of any adjacent temperature values which satisfy the event
definition criteria.</p></li>
<li><p>If the code is used to detect cold events (<code>coldSpells = TRUE</code>),
then it works just as for heat waves except that events are detected as
deviations below the (100 - pctile)th percentile (e.g., the 10th instead of
90th) for at least 5 days. Intensities are reported as negative values and
represent the temperature anomaly below climatology.</p></li>
</ol><p>The original Python algorithm was written by Eric Oliver, Institute for
Marine and Antarctic Studies, University of Tasmania, Feb 2015, and is
documented by Hobday et al. (2016). The marine cold spell option was
implemented in version 0.13 (21 Nov 2015) of the Python module as a result
of our preparation of Schlegel et al. (2017), wherein the cold events
receive a brief overview.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hobday, A.J. et al. (2016). A hierarchical approach to defining
marine heatwaves, Progress in Oceanography, 141, pp. 227-238,
doi:10.1016/j.pocean.2015.12.014</p>
<p>Schlegel, R. W., Oliver, C. J., Wernberg, T. W., Smit, A. J. (2017).
Nearshore and offshore co-occurrences of marine heatwaves and cold-spells.
Progress in Oceanography, 151, pp. 189-205, doi:10.1016/j.pocean.2017.01.004</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>res_clim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ts2clm.html'>ts2clm</a></span>(<span class='no'>sst_WA</span>, <span class='kw'>climatologyPeriod</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"1983-01-01"</span>, <span class='st'>"2012-12-31"</span>))
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>detect_event</span>(<span class='no'>res_clim</span>)
<span class='co'># show a portion of the climatology:</span>
<span class='no'>out</span>$<span class='no'>climatology</span>[<span class='fl'>1</span>:<span class='fl'>10</span>, ]</div><div class='output co'>#&gt; # A tibble: 10 x 10
#&gt;      doy t           temp  seas thresh   var threshCriterion durationCriteri…
#&gt;    &lt;int&gt; &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;           &lt;lgl&gt;           
#&gt;  1     1 1982-01-01  20.9  21.6   23.0 0.959 FALSE           FALSE           
#&gt;  2     2 1982-01-02  21.2  21.6   23.0 0.964 FALSE           FALSE           
#&gt;  3     3 1982-01-03  21.4  21.7   23.0 0.968 FALSE           FALSE           
#&gt;  4     4 1982-01-04  21.2  21.7   23.1 0.973 FALSE           FALSE           
#&gt;  5     5 1982-01-05  21.3  21.7   23.1 0.976 FALSE           FALSE           
#&gt;  6     6 1982-01-06  21.6  21.7   23.1 0.980 FALSE           FALSE           
#&gt;  7     7 1982-01-07  21.7  21.8   23.2 0.983 FALSE           FALSE           
#&gt;  8     8 1982-01-08  21.5  21.8   23.2 0.986 FALSE           FALSE           
#&gt;  9     9 1982-01-09  21.4  21.8   23.2 0.988 FALSE           FALSE           
#&gt; 10    10 1982-01-10  21.4  21.8   23.3 0.991 FALSE           FALSE           
#&gt; # ... with 2 more variables: event &lt;lgl&gt;, event_no &lt;int&gt;</div><div class='input'><span class='co'># show some of the heat waves:</span>
<span class='no'>out</span>$<span class='no'>event</span>[<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='fl'>1</span>:<span class='fl'>10</span>]</div><div class='output co'>#&gt; # A tibble: 5 x 10
#&gt;   event_no index_start index_peak index_end duration date_start date_peak 
#&gt;      &lt;int&gt;       &lt;dbl&gt;      &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt; &lt;date&gt;     &lt;date&gt;    
#&gt; 1        1         885        887       889        5 1984-06-03 1984-06-05
#&gt; 2        2         899        901       904        6 1984-06-17 1984-06-19
#&gt; 3        3         908        922       926       19 1984-06-26 1984-07-10
#&gt; 4        4        1023       1027      1029        7 1984-10-19 1984-10-23
#&gt; 5        5        1033       1034      1037        5 1984-10-29 1984-10-30
#&gt; # ... with 3 more variables: date_end &lt;date&gt;, intensity_mean &lt;dbl&gt;,
#&gt; #   intensity_max &lt;dbl&gt;</div><div class='input'>
<span class='co'># Or if one wants to calculate MCSs</span>
<span class='no'>res_clim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ts2clm.html'>ts2clm</a></span>(<span class='no'>sst_WA</span>, <span class='kw'>climatologyPeriod</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"1983-01-01"</span>, <span class='st'>"2012-12-31"</span>),
                   <span class='kw'>pctile</span> <span class='kw'>=</span> <span class='fl'>10</span>)
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>detect_event</span>(<span class='no'>res_clim</span>, <span class='kw'>coldSpells</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># show a portion of the climatology:</span>
<span class='no'>out</span>$<span class='no'>climatology</span>[<span class='fl'>1</span>:<span class='fl'>10</span>, ]</div><div class='output co'>#&gt; # A tibble: 10 x 10
#&gt;      doy t           temp  seas thresh   var threshCriterion durationCriteri…
#&gt;    &lt;int&gt; &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;           &lt;lgl&gt;           
#&gt;  1     1 1982-01-01  20.9  21.6   20.5 0.959 FALSE           FALSE           
#&gt;  2     2 1982-01-02  21.2  21.6   20.6 0.964 FALSE           FALSE           
#&gt;  3     3 1982-01-03  21.4  21.7   20.6 0.968 FALSE           FALSE           
#&gt;  4     4 1982-01-04  21.2  21.7   20.6 0.973 FALSE           FALSE           
#&gt;  5     5 1982-01-05  21.3  21.7   20.6 0.976 FALSE           FALSE           
#&gt;  6     6 1982-01-06  21.6  21.7   20.7 0.980 FALSE           FALSE           
#&gt;  7     7 1982-01-07  21.7  21.8   20.7 0.983 FALSE           FALSE           
#&gt;  8     8 1982-01-08  21.5  21.8   20.7 0.986 FALSE           FALSE           
#&gt;  9     9 1982-01-09  21.4  21.8   20.8 0.988 FALSE           FALSE           
#&gt; 10    10 1982-01-10  21.4  21.8   20.8 0.991 FALSE           FALSE           
#&gt; # ... with 2 more variables: event &lt;lgl&gt;, event_no &lt;int&gt;</div><div class='input'><span class='co'># show some of the cold-spells:</span>
<span class='no'>out</span>$<span class='no'>event</span>[<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='fl'>1</span>:<span class='fl'>10</span>]</div><div class='output co'>#&gt; # A tibble: 5 x 10
#&gt;   event_no index_start index_peak index_end duration date_start date_peak 
#&gt;      &lt;int&gt;       &lt;dbl&gt;      &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt; &lt;date&gt;     &lt;date&gt;    
#&gt; 1        1          83         83        87        5 1982-03-24 1982-03-24
#&gt; 2        2         194        199       207       14 1982-07-13 1982-07-18
#&gt; 3        3         270        272       277        8 1982-09-27 1982-09-29
#&gt; 4        4         296        303       306       11 1982-10-23 1982-10-30
#&gt; 5        5         672        681       685       14 1983-11-03 1983-11-12
#&gt; # ... with 3 more variables: date_end &lt;date&gt;, intensity_mean &lt;dbl&gt;,
#&gt; #   intensity_max &lt;dbl&gt;</div><div class='input'>
<span class='co'># It is also possible to give two separate sets of threshold criteria</span>

<span class='co'># To use a second static threshold we first use the exceedance function</span>
<span class='no'>thresh_19</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='exceedance.html'>exceedance</a></span>(<span class='no'>sst_Med</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>19</span>, <span class='kw'>minDuration</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>maxGap</span> <span class='kw'>=</span> <span class='fl'>0</span>)$<span class='no'>threshold</span>
<span class='co'># Then we use that output when detecting our events</span>
<span class='no'>events_19</span> <span class='kw'>&lt;-</span> <span class='fu'>detect_event</span>(<span class='fu'><a href='ts2clm.html'>ts2clm</a></span>(<span class='no'>sst_Med</span>, <span class='kw'>climatologyPeriod</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"1982-01-01"</span>, <span class='st'>"2011-12-31"</span>)),
                         <span class='kw'>threshClim2</span> <span class='kw'>=</span> <span class='no'>thresh_19</span>$<span class='no'>exceedance</span>, <span class='kw'>minDuration2</span> <span class='kw'>=</span> <span class='fl'>10</span>, <span class='kw'>maxGap2</span> <span class='kw'>=</span> <span class='fl'>0</span>)

<span class='co'># If we want to use two different percentile thresholds we use detect_event</span>
<span class='no'>thresh_95</span> <span class='kw'>&lt;-</span> <span class='fu'>detect_event</span>(<span class='fu'><a href='ts2clm.html'>ts2clm</a></span>(<span class='no'>sst_Med</span>, <span class='kw'>pctile</span> <span class='kw'>=</span> <span class='fl'>95</span>,
                                 <span class='kw'>climatologyPeriod</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"1982-01-01"</span>, <span class='st'>"2011-12-31"</span>)),
                          <span class='kw'>minDuration</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>maxGap</span> <span class='kw'>=</span> <span class='fl'>0</span>)$<span class='no'>climatology</span>
<span class='co'># Then we use that output when detecting our events</span>
<span class='no'>events_95</span> <span class='kw'>&lt;-</span> <span class='fu'>detect_event</span>(<span class='fu'><a href='ts2clm.html'>ts2clm</a></span>(<span class='no'>sst_Med</span>, <span class='kw'>climatologyPeriod</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"1982-01-01"</span>, <span class='st'>"2011-12-31"</span>)),
                          <span class='kw'>threshClim2</span> <span class='kw'>=</span> <span class='no'>thresh_95</span>$<span class='no'>event</span>, <span class='kw'>minDuration2</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>maxGap2</span> <span class='kw'>=</span> <span class='fl'>0</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Albertus J. Smit, Robert W. Schlegel, Eric C. J. Oliver

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Robert W. Schlegel, Albertus J. Smit.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script>
  docsearch({
    
    
    apiKey: '2edc7627dae0471f3d765c3355bebbf3',
    indexName: 'heatwaver',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>


  </body>
</html>

