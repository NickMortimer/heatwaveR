<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Detection and Visualisation of Events • heatwaveR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Detection and Visualisation of Events">
<meta property="og:description" content="This vignette demonstrates the basic use of the heatwaveR package for the detection and visualisation of events.">
<meta property="og:image" content="https://robwschlegel.github.io/heatwaveR/index.html/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-118123016-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-118123016-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">heatwaveR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.5.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/detection_and_visualisation.html">Basic detection and visualisation</a>
    </li>
    <li>
      <a href="../articles/exceedance.html">Calculating exceedances</a>
    </li>
    <li>
      <a href="../articles/event_categories.html">Calculating categories</a>
    </li>
    <li>
      <a href="../articles/complex_clims.html">Complex climatologies</a>
    </li>
    <li>
      <a href="../articles/OISST_preparation.html">OISST preparation</a>
    </li>
    <li>
      <a href="../articles/gridded_event_detection.html">Extreme event detection in gridded data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/robwschlegel/heatwaveR">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Detection and Visualisation of Events</h1>
                        <h4 class="author">AJ Smit and Robert W Schlegel</h4>
            
            <h4 class="date">2018-12-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/robwschlegel/heatwaveR/blob/master/vignettes/detection_and_visualisation.Rmd"><code>vignettes/detection_and_visualisation.Rmd</code></a></small>
      <div class="hidden name"><code>detection_and_visualisation.Rmd</code></div>

    </div>

    
    
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<p>The <code><a href="../reference/detect_event.html">detect_event()</a></code> function is the core of this package, and it expects to be fed the output of the second core function, <code><a href="../reference/ts2clm.html">ts2clm()</a></code>. By default, <code><a href="../reference/ts2clm.html">ts2clm()</a></code> wants to receive a two-column dataframe with one column labelled <code>t</code> containing all of the date values, and a second column <code>temp</code> containing all of the temperature values. Please note that the date format it expects is “YYYY-MM-DD”. For example, please see the top five rows of one of the datasets included with the <strong><code>heatwaveR</code></strong> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(heatwaveR<span class="op">::</span>sst_WA)</code></pre></div>
<pre><code>##            t  temp
## 1 1982-01-01 20.94
## 2 1982-01-02 21.25
## 3 1982-01-03 21.38
## 4 1982-01-04 21.16
## 5 1982-01-05 21.26
## 6 1982-01-06 21.61</code></pre>
<p>It is possible to use different column names other than <code>t</code> and <code>temp</code> with which to calculate events. Please see the help files for <code><a href="../reference/ts2clm.html">ts2clm()</a></code> or <code><a href="../reference/detect_event.html">detect_event()</a></code> for a thorough explanation of how to do so.</p>
<p>Loading ones data from a <code>.csv</code> file or other text based format is the easiest approach for the calculation of events, assuming one is not working with gridded data (e.g. NetCDF). Please see <a href="https://robwschlegel.github.io/heatwaveR/articles/gridded_event_detection.html">this vignette</a> for a detailed walkthrough on using the functions in this package with gridded data.</p>
</div>
<div id="calculating-marine-heatwaves-mhws" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-marine-heatwaves-mhws" class="anchor"></a>Calculating marine heatwaves (MHWs)</h2>
<p>Here are the <code><a href="../reference/ts2clm.html">ts2clm()</a></code> and <code><a href="../reference/detect_event.html">detect_event()</a></code> function applied to the Western Australia test data included with this package (<code>sst_WA</code>), which are also discussed by Hobday et al. (2016):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load libraries</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(heatwaveR)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)

<span class="co"># Detect the events in a time series</span>
ts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ts2clm.html">ts2clm</a></span>(sst_WA, <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span>))
mhw &lt;-<span class="st"> </span><span class="kw"><a href="../reference/detect_event.html">detect_event</a></span>(ts)

<span class="co"># View just a few metrics</span>
mhw<span class="op">$</span>event <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(event_no, duration, date_start, date_peak, intensity_max, intensity_cumulative) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="op">-</span>intensity_max) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="dv">5</span>)</code></pre></div>
<pre><code>## # A tibble: 5 x 6
##   event_no duration date_start date_peak  intensity_max intensity_cumulati…
##      &lt;dbl&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;             &lt;dbl&gt;               &lt;dbl&gt;
## 1       52      105 2010-12-24 2011-02-28          6.58               293. 
## 2       41       35 2008-03-25 2008-04-14          3.83                79.3
## 3       29       95 1999-05-13 1999-05-22          3.64               240. 
## 4       60       14 2012-12-27 2012-12-31          3.42                32.3
## 5       59      101 2012-01-10 2012-01-27          3.38               214.</code></pre>
</div>
<div id="visualising-marine-heatwaves-mhws" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-marine-heatwaves-mhws" class="anchor"></a>Visualising marine heatwaves (MHWs)</h2>
<div id="default-mhw-visuals" class="section level3">
<h3 class="hasAnchor">
<a href="#default-mhw-visuals" class="anchor"></a>Default MHW visuals</h3>
<p>One may use <code><a href="../reference/event_line.html">event_line()</a></code> and <code><a href="../reference/lolli_plot.html">lolli_plot()</a></code> directly on the output of <code><a href="../reference/detect_event.html">detect_event()</a></code> in order to visualise MHWs. Here are the functions being used to visualise the massive Western Australian heatwave of 2011:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/event_line.html">event_line</a></span>(mhw, <span class="dt">spread =</span> <span class="dv">180</span>, <span class="dt">metric =</span> <span class="st">"intensity_max"</span>, 
           <span class="dt">start_date =</span> <span class="st">"1982-01-01"</span>, <span class="dt">end_date =</span> <span class="st">"2014-12-31"</span>)</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example1-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/lolli_plot.html">lolli_plot</a></span>(mhw, <span class="dt">metric =</span> <span class="st">"intensity_max"</span>)</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example1-2.png" width="768"><!-- ![](vignettes/fig-example1-1.png) --><!-- ![](vignettes/fig-example2-1.png) --></p>
</div>
<div id="custom-mhw-visuals" class="section level3">
<h3 class="hasAnchor">
<a href="#custom-mhw-visuals" class="anchor"></a>Custom MHW visuals</h3>
<p>The <code><a href="../reference/event_line.html">event_line()</a></code> and <code><a href="../reference/lolli_plot.html">lolli_plot()</a></code> functions were designed to work directly on the list returned by <code><a href="../reference/detect_event.html">detect_event()</a></code>. If more control over the figures is required, it may be useful to create them in <strong><code>ggplot2</code></strong> by stacking <code>geoms</code>. We specifically created two new <strong><code>ggplot2</code></strong> <code>geoms</code> to reproduce the functionality of <code><a href="../reference/event_line.html">event_line()</a></code> and <code><a href="../reference/lolli_plot.html">lolli_plot()</a></code>. These functions are more general in their functionality and can be used outside of the <strong><code>heatwaveR</code></strong> package, too. To apply them to MHWs and MCSs first requires that we access the <code>climatology</code> or <code>event</code> dataframes within the list that is produced by <code><a href="../reference/detect_event.html">detect_event()</a></code>. Here is how:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select the region of the time series of interest</span>
mhw2 &lt;-<span class="st"> </span>mhw<span class="op">$</span>climatology <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="dv">10580</span><span class="op">:</span><span class="dv">10720</span>)

<span class="kw">ggplot</span>(mhw2, <span class="kw">aes</span>(<span class="dt">x =</span> t, <span class="dt">y =</span> temp, <span class="dt">y2 =</span> thresh)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_flame.html">geom_flame</a></span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2011-02-25"</span>), <span class="dt">y =</span> <span class="fl">25.8</span>, <span class="dt">label =</span> <span class="st">"the Destroyer</span><span class="ch">\n</span><span class="st">of Kelps"</span>))</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example2-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mhw<span class="op">$</span>event, <span class="kw">aes</span>(<span class="dt">x =</span> date_start, <span class="dt">y =</span> intensity_max)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_lolli.html">geom_lolli</a></span>(<span class="dt">colour =</span> <span class="st">"salmon"</span>, <span class="dt">colour_n =</span> <span class="st">"red"</span>, <span class="dt">n =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">colour =</span> <span class="st">"black"</span>, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.Date">as.Date</a></span>(<span class="st">"2006-08-01"</span>), <span class="dt">y =</span> <span class="dv">5</span>,
                <span class="dt">label =</span> <span class="st">"The marine heatwaves</span><span class="ch">\n</span><span class="st">Tend to be left skewed in a</span><span class="ch">\n</span><span class="st">Given time series"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Max. intensity ["</span>, degree, <span class="st">"C]"</span>)), <span class="dt">x =</span> <span class="ot">NULL</span>)</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example2-2.png" width="768"><!-- ![](vignettes/fig-example3-1.png) --><!-- ![](vignettes/fig-example3-2.png) --></p>
</div>
<div id="spicy-mhw-visuals" class="section level3">
<h3 class="hasAnchor">
<a href="#spicy-mhw-visuals" class="anchor"></a>Spicy MHW visuals</h3>
<p>The default output of these function may not be to your liking. If so, not to worry. As <strong><code>ggplot2</code></strong> <code>geoms</code>, they are highly malleable. For example, if we were to choose to reproduce the format of the MHWs as seen in Hobday et al. (2016), the code would look something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># It is necessary to give geom_flame() at least one row on either side of </span>
<span class="co"># the event in order to calculate the polygon corners smoothly</span>
mhw_top &lt;-<span class="st"> </span>mhw2 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="dv">49</span><span class="op">:</span><span class="dv">110</span>)

<span class="kw">ggplot</span>(<span class="dt">data =</span> mhw2, <span class="kw">aes</span>(<span class="dt">x =</span> t)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_flame.html">geom_flame</a></span>(<span class="kw">aes</span>(<span class="dt">y =</span> temp, <span class="dt">y2 =</span> thresh, <span class="dt">fill =</span> <span class="st">"all"</span>), <span class="dt">show.legend =</span> T) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_flame.html">geom_flame</a></span>(<span class="dt">data =</span> mhw_top, <span class="kw">aes</span>(<span class="dt">y =</span> temp, <span class="dt">y2 =</span> thresh, <span class="dt">fill =</span> <span class="st">"top"</span>), <span class="dt">show.legend =</span> T) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> temp, <span class="dt">colour =</span> <span class="st">"temp"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> thresh, <span class="dt">colour =</span> <span class="st">"thresh"</span>), <span class="dt">size =</span> <span class="fl">1.0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> seas, <span class="dt">colour =</span> <span class="st">"seas"</span>), <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">name =</span> <span class="st">"Line Colour"</span>,
                      <span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"temp"</span> =<span class="st"> "black"</span>, <span class="st">"thresh"</span> =<span class="st">  "forestgreen"</span>, <span class="st">"seas"</span> =<span class="st"> "grey80"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">name =</span> <span class="st">"Event Colour"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"all"</span> =<span class="st"> "salmon"</span>, <span class="st">"top"</span> =<span class="st"> "red"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">fill =</span> <span class="ot">NA</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Temperature ["</span>, degree, <span class="st">"C]"</span>)), <span class="dt">x =</span> <span class="ot">NULL</span>)</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example3-1.png" width="768"><!-- ![](vignettes/fig-example4-1.png) --></p>
<p>Should we not wish to highlight any events with <code><a href="../reference/geom_lolli.html">geom_lolli()</a></code>, plot them with a colour other than the default, and use a different theme, it would look like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mhw<span class="op">$</span>event, <span class="kw">aes</span>(<span class="dt">x =</span> date_peak, <span class="dt">y =</span> intensity_max)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_lolli.html">geom_lolli</a></span>(<span class="dt">colour =</span> <span class="st">"firebrick"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Peak Date"</span>, 
       <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Max. intensity ["</span>, degree, <span class="st">"C]"</span>)), <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_linedraw</span>()</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example4-1.png" width="768"><!-- ![](vignettes/fig-example5-1.png) --></p>
<p>Because these are simple <strong><code>ggplot2</code></strong> geoms possibilities are nearly infinite.</p>
</div>
</div>
<div id="calculating-marine-cold-spells-mcss" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-marine-cold-spells-mcss" class="anchor"></a>Calculating marine cold-spells (MCSs)</h2>
<p>The calculation and visualisation of cold-spells is also provided for within this package. The data to be fed into the functions is the same as for MHWs. The main difference is that one is now calculating the 10th percentile threshold, rather than the 90th percentile threshold. Here are the top five cold-spells (cumulative intensity) detected in the OISST data for Western Australia:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First calculate the cold-spells</span>
ts_10th &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ts2clm.html">ts2clm</a></span>(sst_WA, <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2011-12-31"</span>), <span class="dt">pctile =</span> <span class="dv">10</span>)
mcs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/detect_event.html">detect_event</a></span>(ts_10th, <span class="dt">coldSpells =</span> <span class="ot">TRUE</span>)

<span class="co"># Then look at the top few events</span>
mcs<span class="op">$</span>event <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span>() <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/select.html">select</a></span>(event_no, duration, date_start,
                date_peak, intensity_mean, intensity_max, intensity_cumulative) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(intensity_cumulative) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(<span class="dv">5</span>)</code></pre></div>
<pre><code>## # A tibble: 5 x 7
##   event_no duration date_start date_peak  intensity_mean intensity_max
##      &lt;dbl&gt;    &lt;dbl&gt; &lt;date&gt;     &lt;date&gt;              &lt;dbl&gt;         &lt;dbl&gt;
## 1       15       76 1990-04-13 1990-05-11          -2.50         -3.19
## 2       49       58 2003-12-19 2004-01-23          -1.73         -2.59
## 3       64       52 2014-04-14 2014-05-05          -1.78         -2.54
## 4        7       37 1986-06-24 1986-07-17          -2.00         -2.91
## 5       46       32 2003-09-08 2003-09-16          -1.53         -2.09
## # ... with 1 more variable: intensity_cumulative &lt;dbl&gt;</code></pre>
</div>
<div id="visualising-marine-cold-spells-mcss" class="section level2">
<h2 class="hasAnchor">
<a href="#visualising-marine-cold-spells-mcss" class="anchor"></a>Visualising marine cold-spells (MCSs)</h2>
<div id="default-mcs-visuals" class="section level3">
<h3 class="hasAnchor">
<a href="#default-mcs-visuals" class="anchor"></a>Default MCS visuals</h3>
<p>The default plots showing cold-spells look like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/event_line.html">event_line</a></span>(mcs, <span class="dt">spread =</span> <span class="dv">200</span>, <span class="dt">metric =</span> <span class="st">"intensity_cumulative"</span>,
           <span class="dt">start_date =</span> <span class="st">"1982-01-01"</span>, <span class="dt">end_date =</span> <span class="st">"2014-12-31"</span>)</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example5-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/lolli_plot.html">lolli_plot</a></span>(mcs, <span class="dt">metric =</span> <span class="st">"intensity_cumulative"</span>, <span class="dt">xaxis =</span> <span class="st">"event_no"</span>)</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example5-2.png" width="768"><!-- ![](vignettes/fig-example6-1.png) --><!-- ![](vignettes/fig-example6-2.png) --></p>
<p>Note that one does not need to specify that MCSs are to be visualised, the functions are able to understand this on their own.</p>
</div>
<div id="custom-mcs-visuals" class="section level3">
<h3 class="hasAnchor">
<a href="#custom-mcs-visuals" class="anchor"></a>Custom MCS visuals</h3>
<p>Cold spell figures may be created as <code>geoms</code> in <strong><code>ggplot2</code></strong>, too:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select the region of the time series of interest</span>
mcs2 &lt;-<span class="st"> </span>mcs<span class="op">$</span>climatology <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="dv">2900</span><span class="op">:</span><span class="dv">3190</span>)

<span class="co"># Note that one must specify a colour other than the default 'salmon'</span>
<span class="kw">ggplot</span>(mcs2, <span class="kw">aes</span>(<span class="dt">x =</span> t, <span class="dt">y =</span> thresh, <span class="dt">y2 =</span> temp)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_flame.html">geom_flame</a></span>(<span class="dt">fill =</span> <span class="st">"steelblue3"</span>)</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example6-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mcs<span class="op">$</span>event, <span class="kw">aes</span>(<span class="dt">x =</span> date_start, <span class="dt">y =</span> intensity_max)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_lolli.html">geom_lolli</a></span>(<span class="dt">colour =</span> <span class="st">"steelblue3"</span>, <span class="dt">colour_n =</span> <span class="st">"navy"</span>, <span class="dt">n =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">"Start Date"</span>,
       <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Max. intensity ["</span>, degree, <span class="st">"C]"</span>)))</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example6-2.png" width="768"></p>
</div>
<div id="minty-mcs-visuals" class="section level3">
<h3 class="hasAnchor">
<a href="#minty-mcs-visuals" class="anchor"></a>Minty MCS visuals</h3>
<p>Again, because <code><a href="../reference/geom_flame.html">geom_flame()</a></code> and <code><a href="../reference/geom_lolli.html">geom_lolli()</a></code> are simple <strong><code>ggplot2</code></strong> geoms, one can go completely bananas with them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mcs_top &lt;-<span class="st"> </span>mcs2 <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/slice.html">slice</a></span>(<span class="dv">125</span><span class="op">:</span><span class="dv">202</span>)

<span class="kw">ggplot</span>(<span class="dt">data =</span> mcs2, <span class="kw">aes</span>(<span class="dt">x =</span> t)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_flame.html">geom_flame</a></span>(<span class="kw">aes</span>(<span class="dt">y =</span> thresh, <span class="dt">y2 =</span> temp, <span class="dt">fill =</span> <span class="st">"all"</span>), <span class="dt">show.legend =</span> T) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_flame.html">geom_flame</a></span>(<span class="dt">data =</span> mcs_top, <span class="kw">aes</span>(<span class="dt">y =</span> thresh, <span class="dt">y2 =</span> temp, <span class="dt">fill =</span> <span class="st">"top"</span>), <span class="dt">show.legend =</span> T) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> temp, <span class="dt">colour =</span> <span class="st">"temp"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> thresh, <span class="dt">colour =</span> <span class="st">"thresh"</span>), <span class="dt">size =</span> <span class="fl">1.0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> seas, <span class="dt">colour =</span> <span class="st">"seas"</span>), <span class="dt">size =</span> <span class="fl">1.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">name =</span> <span class="st">"Line Colour"</span>,
                      <span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"temp"</span> =<span class="st"> "black"</span>, <span class="st">"thresh"</span> =<span class="st">  "forestgreen"</span>, <span class="st">"seas"</span> =<span class="st"> "grey80"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">name =</span> <span class="st">"Event Colour"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"all"</span> =<span class="st"> "steelblue3"</span>, <span class="st">"top"</span> =<span class="st"> "navy"</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">date_labels =</span> <span class="st">"%b %Y"</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">fill =</span> <span class="ot">NA</span>))) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Temperature ["</span>, degree, <span class="st">"C]"</span>)), <span class="dt">x =</span> <span class="ot">NULL</span>)</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example7-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mcs<span class="op">$</span>event, <span class="kw">aes</span>(<span class="dt">x =</span> date_start, <span class="dt">y =</span> intensity_cumulative)) <span class="op">+</span>
<span class="st">  </span><span class="kw"><a href="../reference/geom_lolli.html">geom_lolli</a></span>(<span class="dt">colour =</span> <span class="st">"steelblue3"</span>, <span class="dt">colour_n =</span> <span class="st">"navy"</span>, <span class="dt">n =</span> <span class="dv">7</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>( <span class="dt">x =</span> <span class="st">"Start Date"</span>, <span class="dt">y =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/expression">expression</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"Cumulative intensity [days x "</span>, degree, <span class="st">"C]"</span>)))</code></pre></div>
<p><img src="detection_and_visualisation_files/figure-html/fig-example7-2.png" width="768"><!-- ![](vignettes/fig-example7-1.png) --><!-- ![](vignettes/fig-example7-2.png) --></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#data">Data</a></li>
      <li><a href="#calculating-marine-heatwaves-mhws">Calculating marine heatwaves (MHWs)</a></li>
      <li><a href="#visualising-marine-heatwaves-mhws">Visualising marine heatwaves (MHWs)</a></li>
      <li><a href="#calculating-marine-cold-spells-mcss">Calculating marine cold-spells (MCSs)</a></li>
      <li><a href="#visualising-marine-cold-spells-mcss">Visualising marine cold-spells (MCSs)</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Robert W. Schlegel, Albertus J. Smit.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '2edc7627dae0471f3d765c3355bebbf3',
    indexName: 'heatwaver',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
